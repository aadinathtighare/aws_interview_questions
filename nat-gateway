जर तुम्ही EKS वापरत असाल, तर तुमचे वर्कर नोड्स प्रायव्हेट सबनेटमध्ये असतात. त्यांना क्लस्टरच्या कंट्रोल प्लेनशी आणि इमेज रिपॉझिटरीशी (ECR) बोलण्यासाठी या NAT Gateway ची गरज असते.
NAT Gateway ऐवजी NAT Instance (जो स्वस्त असतो) कसा वापरायचा किंवा VPC Endpoints (ज्यामुळे NAT चा खर्च वाचतो).

Key Notes-->
Elastic IP: NAT Gateway तयार करताना त्याला एक Elastic IP असणे अनिवार्य आहे, कारण त्याशिवाय तो बाहेरील जगाशी (Internet) संपर्क साधू शकत नाही.

One-way Traffic: इंटरनेटवरील कोणीही बाहेरून थेट NAT Gateway द्वारे तुमच्या प्रायव्हेट सर्व्हरला एक्सेस करू शकत नाही. फक्त तुमच्या आतल्या सर्व्हर्सना बाहेर जाता येते (उदा. सॉफ्टवेअर अपडेट्ससाठी).

Cost: NAT Gateway चा खर्च प्रति तास आणि डेटा प्रोसेसिंगनुसार असतो. जर तुम्हाला खर्च कमी करायचा असेल, तर तुम्ही प्रत्येक AZ मध्ये NAT न ठेवता एकाच AZ मध्ये ठेवू शकता (मात्र यामुळे Redundancy कमी होते).
---------------------------------------
१. Route Table कॉन्फिगरेशन (The Setup)
तुम्हाला दोन वेगळे Route Tables लागतात:

Public Route Table: यामध्ये इंटरनेट ट्रॅफिकसाठी Internet Gateway (IGW) सेट केलेले असते. याच सबनेटमध्ये NAT Gateway ठेवले जाते.

Private Route Table: यामध्ये इंटरनेट ट्रॅफिकसाठी (0.0.0.0/0) NAT Gateway ID (nat-xxxxxxxx) सेट केला जातो.
-----------------------------------------------------
Q. nat gateway is uni direction or bi-direction ? uni direction
Internet Gateway (Bi-directional): पब्लिक सबनेटसाठी वापरले जाते. इथे बाहेरून ट्रॅफिक आत येऊ शकते (उदा. तुमच्या वेबसाईटला व्हिजिट करणारे लोक)
Initiation (सुरुवात): फक्त तुमच्या Private Subnet मधील सर्व्हर्स इंटरनेटशी संपर्क सुरू करू शकतात. इंटरनेटवरील कोणीही बाहेरून थेट तुमच्या सर्व्हरशी संपर्क सुरू करू शकत नाही. या अर्थाने ते Uni-directional आहे.

Response (प्रतिसाद): एकदा तुमच्या सर्व्हरने विनंती (Request) पाठवली की, इंटरनेटवरून येणारा त्याचा प्रतिसाद (Response) NAT Gateway आत येऊ देते. याला Stateful वर्तन म्हणतात.
Outbound (बाहेर जाणारे)	Allowed: प्रायव्हेट सबनेटमधील पॉड्स किंवा सर्व्हर्स सॉफ्टवेअर अपडेट्स किंवा API कॉल्ससाठी बाहेर जाऊ शकतात.
Inbound (आत येणारे)	Blocked: इंटरनेटवरून येणारे "नवीन" कनेक्शन (उदा. हॅकरचा प्रयत्न) NAT Gateway ब्लॉक करते.
Stateful Nature	NAT Gateway लक्षात ठेवते की कोणत्या सर्व्हरने बाहेर विनंती पाठवली आहे, त्यामुळे फक्त त्या विनंतीचा परतीचा डेटा तो आत येऊ देतो.
--------------------------------------------------------------------------------------------------
Isolated Subnet: यामध्ये Internet Gateway (IGW) किंवा NAT Gateway यापैकी कशाचाही मार्ग नसतो. या सबनेटमधील ट्रॅफिक फक्त VPC च्या आतच फिरू शकते.
Database Tier: उदा. RDS किंवा मॅन्युअली इन्स्टॉल केलेले डेटाबेस.
subnet group
-----------------------------------------------------------------------------
३. इंटरनेटशिवाय काम कसे चालते? (VPC Endpoints)
जर एखाद्या आयसोलेटेड सबनेटमधील डेटाबेसला S3 वर बॅकअप घ्यायचा असेल किंवा ECR कडून इमेज हवी असेल, तर तो इंटरनेटवर जाऊ शकत नाही. अशा वेळी आपण VPC Endpoints (PrivateLink) वापरतो.

यामुळे ट्रॅफिक AWS च्या अंतर्गत नेटवर्कमधूनच प्रवास करते, इंटरनेटवर न जाता.
-----------------------------------------------
Q. how the servers are communicates each other inside vpc ?

--> via local route in route table.   VPC चा CIDR 10.0.0.0/16 
-----------------------------------------------
दोन सर्व्हर्समधील अडथळे (Security Checkpoints)
जरी Local Route मुळे रस्ता मोकळा असला, तरी संवाद होण्यासाठी दोन सुरक्षा स्तर (Layers) पार करावे लागतात:

Security Groups (Stateful): हे इन्स्टन्स लेव्हलवर काम करतात. Server B च्या Security Group मध्ये Server A चा आयपी किंवा त्याचा Security Group ID 'Allow' असणे गरजेचे आहे.

NACL (Network Access Control List - Stateless): हे सबनेट लेव्हलवर काम करतात. जर सबनेट A आणि सबनेट B मधील 'Inbound/Outbound' नियम बरोबर नसतील, तर संवाद होणार नाही
-----------------------------------------------
Q. i have webserver separate security group , app tier have separate sg , rds have separate sg now i need to allow manually exa. in rds sg i need to allow app tier sg id ?
--> security group piping mechanism
Web Server SG --> 
App Tier SG --> Web Server SG ID (फक्त वेब सर्व्हरकडून येणारे ट्रॅफिक)

RDS (Database) SG --> App Tier SG ID (फक्त ॲप सर्व्हरकडून येणारे ट्रॅफिक)
----------------------------------------------------
Terraform वापरताना तुम्ही source_security_group_id वापरून हे ऑटोमेट करू शकता:
=====================================


-----------------------------------------------

